

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>alframework.samplers.ASE_ensemble_constructor &mdash; ALF 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ALF
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../home.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">alframework</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ALF</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">alframework.samplers.ASE_ensemble_constructor</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for alframework.samplers.ASE_ensemble_constructor</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">ase.calculators.calculator</span> <span class="kn">import</span> <span class="n">Calculator</span><span class="p">,</span><span class="n">all_changes</span>
<span class="kn">from</span> <span class="nn">ase.calculators.mixing</span> <span class="kn">import</span> <span class="n">Mixer</span>

<div class="viewcode-block" id="Well_Potential">
<a class="viewcode-back" href="../../../alframework.samplers.html#alframework.samplers.ASE_ensemble_constructor.Well_Potential">[docs]</a>
<span class="k">class</span> <span class="nc">Well_Potential</span><span class="p">(</span><span class="n">Calculator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This calculator applies a restoring force to constrain a series of </span>
<span class="sd">    This is useful for cluster simulations</span>
<span class="sd">    r_start: distance from origin where potential starts, in Angstrom</span>
<span class="sd">    force: magnitudue of resotring force in eV/Angstrom</span>
<span class="sd">    origin: The center point of the spherical well potential</span>
<span class="sd">    zero_properties: In order to mix this calculator with other calculators, it must have the same implemented  properties list. this calculator will spoof those properties and return np.array(0) which should not change other propertys mixed with the mixer.</span>
<span class="sd">    mass_weighted: Flag to configure if forces applied to atoms should be mass weighted. Default is true to make each atom experience the same acceleration (keeping molecules together)</span>
<span class="sd">    #Todo: Add cos()**2 switching function.</span>
<span class="sd">    #TODO: Add drag term when in the potential to prevent orbits. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r_start</span><span class="p">,</span><span class="n">force</span><span class="p">,</span><span class="n">origin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">zero_properties</span><span class="o">=</span><span class="p">[],</span><span class="n">mass_weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">Calculator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_start</span><span class="o">=</span><span class="n">r_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force</span><span class="o">=</span><span class="n">force</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_weighted</span> <span class="o">=</span> <span class="n">mass_weighted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span> <span class="o">=</span> <span class="n">zero_properties</span>
        <span class="k">if</span> <span class="s1">&#39;energy&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;energy&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;forces&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;potential_energy&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;forces&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;forces&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span> <span class="s1">&#39;forces&#39;</span><span class="p">,</span> <span class="s1">&#39;potential_energy&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">zero_properties</span>
    
<div class="viewcode-block" id="Well_Potential.calculate">
<a class="viewcode-back" href="../../../alframework.samplers.html#alframework.samplers.ASE_ensemble_constructor.Well_Potential.calculate">[docs]</a>
    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span><span class="n">system_changes</span><span class="o">=</span><span class="n">all_changes</span><span class="p">):</span>
        <span class="n">Calculator</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">system_changes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">relative_positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_weighted</span><span class="p">:</span>
            <span class="n">mass_vector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">get_masses</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mass_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">))</span>
            
        <span class="n">depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_positions</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_start</span>
        <span class="n">in_potential</span> <span class="o">=</span> <span class="n">depth</span><span class="o">&gt;</span><span class="mi">0</span>
        <span class="n">in_hole</span> <span class="o">=</span> <span class="n">depth</span><span class="o">&lt;</span><span class="mi">0</span>
        <span class="n">depth</span><span class="p">[</span><span class="n">depth</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">unit_vectors</span> <span class="o">=</span> <span class="p">(</span><span class="n">relative_positions</span><span class="o">.</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="mf">1e-4</span><span class="o">*</span><span class="n">in_hole</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">relative_positions</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">T</span> <span class="c1">#Unit vectors not perfectly normalized for atoms in the flat piece of well</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mass_vector</span><span class="o">*</span><span class="n">depth</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">force</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;forces&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">unit_vectors</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">in_potential</span><span class="o">*</span><span class="n">mass_vector</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">force</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">for</span> <span class="n">current_property</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_property</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zero_properties</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">current_property</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>
</div>

        
<div class="viewcode-block" id="MLMD_calculator">
<a class="viewcode-back" href="../../../alframework.samplers.html#alframework.samplers.ASE_ensemble_constructor.MLMD_calculator">[docs]</a>
<span class="k">class</span> <span class="nc">MLMD_calculator</span><span class="p">(</span><span class="n">Calculator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a calculator that enables MLMD sampling with an ensemble of ML potentials </span>
<span class="sd">    models: a list of ASE calculators that are joined to perform MD. </span>
<span class="sd">    well_params: Inputs for the well potential above, which enables constrained MD simulations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">models</span><span class="p">,</span><span class="n">well_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">debug_print</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">Calculator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug_print</span> <span class="o">=</span> <span class="n">debug_print</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N_models</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">models</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">N_models</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N_models</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculator_properties</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">calc</span><span class="o">.</span><span class="n">implemented_properties</span><span class="p">)</span> <span class="k">for</span> <span class="n">calc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">debug_print</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;calculator properties:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculator_properties</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="c1">#self.implemented_properties = self.calculator_properties.copy()</span>
        
        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">well_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;zero_properties&#39;</span> <span class="ow">in</span> <span class="n">well_params</span><span class="p">:</span>
                <span class="n">well_params</span><span class="p">[</span><span class="s1">&#39;zero_properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">well_params</span><span class="p">[</span><span class="s1">&#39;zero_properties&#39;</span><span class="p">]),</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculator_properties</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">well_params</span><span class="p">[</span><span class="s1">&#39;zero_properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculator_properties</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Well_Potential</span><span class="p">(</span><span class="o">**</span><span class="n">well_params</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mixer</span> <span class="o">=</span> <span class="n">Mixer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">implemented_properties</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
            
        <span class="k">if</span> <span class="s1">&#39;energy&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;energy_stdev&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;forces&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;forces_stdev_mean&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">implemented_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;forces_stdev_max&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="MLMD_calculator.calculate">
<a class="viewcode-back" href="../../../alframework.samplers.html#alframework.samplers.ASE_ensemble_constructor.MLMD_calculator.calculate">[docs]</a>
    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">atoms</span><span class="p">,</span><span class="n">properties</span><span class="p">,</span><span class="n">system_changes</span><span class="o">=</span><span class="n">all_changes</span><span class="p">):</span>
        <span class="n">Calculator</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="n">system_changes</span><span class="p">)</span>
        <span class="n">add_properties</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;energy_stdev&#39;</span> <span class="ow">in</span> <span class="n">add_properties</span><span class="p">:</span>
            <span class="n">add_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;energy&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;forces_stdev_max&#39;</span> <span class="ow">in</span> <span class="n">add_properties</span> <span class="ow">or</span> <span class="s1">&#39;forces_stdev_mean&#39;</span> <span class="ow">in</span> <span class="n">add_properties</span><span class="p">:</span>
            <span class="n">add_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;forces&quot;</span><span class="p">)</span>
        <span class="n">run_properties</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calculator_properties</span><span class="p">),</span><span class="nb">set</span><span class="p">(</span><span class="n">add_properties</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixer</span><span class="o">.</span><span class="n">get_properties</span><span class="p">(</span><span class="n">run_properties</span><span class="p">,</span><span class="n">atoms</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;energy_stdev&#39;</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy_stdev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;energy_contributions&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">N_models</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;forces_stdev_mean&#39;</span> <span class="ow">in</span> <span class="n">properties</span> <span class="ow">or</span> <span class="s1">&#39;forces_stdev_max&#39;</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">force_stdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;forces_contributions&#39;</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">N_models</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;forces_stdev_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">force_stdev</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;forces_stdev_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">force_stdev</span><span class="p">))</span></div>
</div>

        
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, B. Nebgen, V. Grizzi, N. Fedik, N. Lubbers, Y.-W. Li, S. Tretiak.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>